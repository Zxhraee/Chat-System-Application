<button routerLink="/menu" class="back-btn">Back to Menu</button>
<h1 class="app-title"> {{ activeGroup?.name }} Chat </h1>

<section class="chat-shell" id="chat">
  <header class="chat-header">
    {{ activeGroup?.name }} /
    <select [ngModel]="channelId" (ngModelChange)="goChannel($event)" class="channel-select">
      <option *ngFor="let c of channels" [ngValue]="c.id">{{ c.name }}</option>
    </select>
    Chat
  </header>

  <div class="chat-body">
    <div *ngIf="viewMessages.length === 0" class="chat-empty">
      No messages yet.
    </div>

    <div *ngFor="let m of viewMessages">
      <div class="chat-message">
        <img class="chat-avatar" [src]="m.avatarUrl || '../assets/default-avatar.png'" />
        <div class="chat-row">
          <span class="chat-author">{{ m.username }}</span>
          <span class="chat-text">{{ m.text }}</span>
          <img [src]="m.imageUrl" class="chat-image" (load)="onImageLoad($event)" />
          <div class="chat-when"> {{ m.timestamp | date:'d MMMM y, h:mm a' }}</div>
        </div>
      </div>
    </div>
  </div>

  <form class="chat-form" (submit)="$event.preventDefault(); send();">
    <input [(ngModel)]="input" name="chatInput" placeholder="Messageâ€¦" class="chat-input" autocomplete="off" />
    <input type="file" accept="image/*" #imagePicker hidden (change)="pickImage($event)" />

    <button type="button" class="chat-send" (click)="imagePicker.click()" title="Send image">ðŸ“¸</button>
    <button type="submit" class="chat-send">Send</button>
  </form>
</section>