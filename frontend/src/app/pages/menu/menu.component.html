<h1 class="app-title">Chat System</h1>

<section class="chat-shell" id="chat">
  <!-- Chat & Channel Name (General)Â -->
  <header class="chat-header">
    General /
    <select [ngModel]="channelId" (ngModelChange)="setChannel($event)" class="channel-select">
      <option *ngFor="let c of channels; trackBy: trackById" [value]="c.id">
        {{ c.name }}
      </option>
    </select>
    Chat
  </header>

  <!-- Message DisplayÂ -->
  <div class="chat-body">
    <div *ngIf="viewMessages.length === 0" class="chat-empty">
      No messages yet.
    </div>

    <div *ngFor="let m of viewMessages; trackBy: trackByMessageId">
      <div class="chat-message">
        <!-- User Profile ImageÂ -->
        <img class="chat-avatar" [src]="m.avatarUrl || '../assets/default-avatar.png'" alt="Avatar" />
        <div class="chat-row">
          <span class="chat-author">{{ m.username }}</span>
          <span class="chat-text">{{ m.text }}</span>
          <div class="chat-image-line">
          <!-- Message Image DisplayÂ -->
          <img [src]="m.imageUrl" class="chat-image" (load)="onImageLoad($event)" />
          </div>
          <span class="chat-when"> {{ m.timestamp | date:'d MMMM y, h:mm a' }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <form class="chat-form" (submit)="$event.preventDefault(); send();">
    <!-- Chat Input FieldÂ -->
    <input name="chatInput" [(ngModel)]="input" placeholder="Messageâ€¦" class="chat-input" autocomplete="off" />
    <!-- Image SelectorÂ -->
    <input type="file" accept="image/*" #imagePicker hidden (change)="pickImage($event)" />
    <button type="button" class="chat-send" (click)="imagePicker.click()" title="Send image">ðŸ“¸</button>
    <!-- Message Send ButtonÂ -->
    <button type="submit" class="chat-send">Send</button>
  </form>
</section>

<!-- My GroupsÂ -->
<h2>My Groups</h2>

<section class="groups" *ngIf="myGroups as myGroups">
  <div *ngIf="myGroups.length === 0" class="groups-empty">
    You don't belong to any groups yet.
  </div>

  <ul class="groups-list">
    <ng-container *ngFor="let g of myGroups; trackBy: trackById">
      <li *ngIf="!isGeneralGroup(g)" class="group-item">
        <strong class="group-name">{{ g.name }}</strong>
        <div class="group-actions">
          <!-- Open Group Chat Button -->
          <button (click)="openGroupDefaultChannel(g)" class="btn-primary">
            Open group chat
          </button>
        </div>
      </li>
    </ng-container>
  </ul>
</section>